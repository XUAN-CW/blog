<!DOCTYPE html> <html style lang=zh-cn><!--
 Page saved with SingleFile 
 url: https://www.cnblogs.com/gelandesprung/p/13292659.html 
 saved date: Thu Mar 11 2021 11:27:14 GMT+0800 (中国标准时间)
--><meta charset=utf-8>
<meta name=viewport content="width=device-width, initial-scale=1.0">
<meta name=referrer content=origin>
<meta name=description content="docker安装NextCloud Docker部署NextCloud总结 我反复的安装了很多遍，虽然最后成功了，但是我完全搞不清楚最后一次成功和以前的失败有什么的不同 安装方法 我是通过配置脚本安装">
<meta property=og:description content="docker安装NextCloud Docker部署NextCloud总结 我反复的安装了很多遍，虽然最后成功了，但是我完全搞不清楚最后一次成功和以前的失败有什么的不同 安装方法 我是通过配置脚本安装">
<meta http-equiv=Cache-Control content=no-transform>
<meta http-equiv=Cache-Control content=no-siteapp>
<meta http-equiv=X-UA-Compatible content="IE=edge">
<title>Docker部署NextCloud总结 - _Gelandesprung - 博客园</title>
<style>.navbar{display:flex;flex-direction:column;align-items:center;padding-left:40px;padding-right:40px}pre{overflow:auto}pre{margin-top:0;margin-bottom:0}blockquote{border:2px solid #efefef;padding-left:10px;padding-right:10px;padding-top:5px;padding-bottom:5px;margin-top:10px;margin-bottom:10px}.blogpost-body blockquote{border-left:3px solid #e2dfdf;border-right:none;border-top:none;border-bottom:none;margin:10px 0}#cnblogs_post_body{margin-bottom:20px}#cnblogs_post_body ul{margin-left:30px;padding-left:0}#cnblogs_post_body ul li{list-style-type:disc}#cnblogs_post_body{word-break:break-word}#cnblogs_post_body p{margin:10px auto;text-indent:0}#cnblogs_post_body h1{font-size:28px;font-weight:bold;line-height:1.5;margin:10px 0}#cnblogs_post_body h2{font-size:21px;font-weight:bold;line-height:1.5;margin:10px 0}.vertical-middle>*{vertical-align:middle}.blogpost-body-html pre.codeblock{background-color:#f5f5f5;padding:10px}.hljs-keyword,.hljs-selector-tag,.hljs-built_in{color:#00f}.hljs-string,.hljs-attribute,.hljs-literal{color:#a31515}.hljs-attr{color:#f00}.hljs-bullet{color:#00b0e8}@-webkit-keyframes ui-dialog-loading{0%{-webkit-transform:rotate(0deg)}100%{-webkit-transform:rotate(360deg)}}@keyframes ui-dialog-loading{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}*{margin:0;padding:0}html{height:100%}body{color:#464646;font-family:'PingFang SC','Microsoft YaHei','Helvetica Neue','Helvetica','Arial',sans-serif;font-size:9pt;min-height:101%;background:transparent url(data:image/jpeg;base64,/9j/4AAQSkZJRgABAgAAZABkAAD/7AARRHVja3kAAQAEAAAAWQAA/+4ADkFkb2JlAGTAAAAAAf/bAIQAAQEBAQEBAQEBAQIBAQECAgIBAQICAwICAgICAwMDAwMDAwMDAwQEBAQEAwUFBgYFBQgHBwcICAgICAgICAgICAEBAQEDAgMFAwMFBwYFBgcICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgI/8AAEQgBRgACAwERAAIRAQMRAf/EAGoAAAMAAwAAAAAAAAAAAAAAAAAEBQMJCgEBAQEBAQAAAAAAAAAAAAAAAAECBQYQAQACAgEBCQEAAAAAAAAAAAABE1FhEqHwAlJiA5TVVgcZEQEBAAEFAAAAAAAAAAAAAAAAEQEhoVIDFP/aAAwDAQACEQMRAD8A533jnXAAG63+V3p/Uf0b2EfEuP7O3jtkdX3B1GjFc4UN8dIG65w1A7wjCodrjtAU9XqFD9WupEUKvL1BRq00ihTrqoo16hIKNbSRSrhYKVSlUK9FSqVS0qhVGFSqFc4hRQr0QPVRhYQ7wWoe4SaLDnDu4WMmeMYhVhqufCFZxAAAAAAAAAAAAf/Z) repeat-x;background-color:#faf7ef}body.has-navbar{background-position-y:42px;padding-top:42px}ul{word-break:break-all}li{list-style:none}a:link{color:#464646;text-decoration:none}a:visited{color:#464646;text-decoration:none}a:hover{color:#4c4f8b}a:active{color:#464646;text-decoration:none}.clear{clear:both}.navbar{padding-top:5px;padding-bottom:5px;margin-top:-42px;background-color:transparent}#home{margin:0 auto;width:95%;min-width:930px;position:relative}#main{width:100%;min-width:950px;text-align:left}#mainContent .forFlow{margin-left:24em;float:none;width:auto}#mainContent{min-height:200px;padding:0 0 10px 0;-o-text-overflow:ellipsis;text-overflow:ellipsis;overflow:hidden;word-break:break-all;float:right;margin-left:-25em;width:100%}.postTitle{clear:both}.postTitle a:link,.postTitle a:visited,.postTitle a:active{color:#6466b3}.postTitle a:hover{color:#f60}.postDesc{clear:both}.postDesc a:link,.postDesc a:visited,.postDesc a:active{color:#666}.postDesc a:hover{color:#f60;text-decoration:none}#sideBar{width:250px;min-height:200px;padding:16px 0 0 5px;float:left;-o-text-overflow:ellipsis;text-overflow:ellipsis;overflow:hidden;word-break:break-all;color:#88866f}#topics{width:100%;min-height:200px;padding:0 0 10px 0;-o-text-overflow:ellipsis;text-overflow:ellipsis;overflow:hidden}#topics .postTitle{font-size:130%;font-weight:bold;float:left;line-height:1.5em;width:100%;padding-left:5px;margin-bottom:15px}.postBody{padding:5px 2px 5px 5px;border-bottom:1px solid #000}#topics .postDesc{float:right;width:100%;text-align:right;padding-right:5px;color:#666;margin-top:5px}.postBody{line-height:1.5;color:#393939;font-size:14px}.postBody li{margin-bottom:1em}.postBody blockquote{background:url(data:image/gif;base64,R0lGODlhIAAYAOYAAAAAAP////b09fHv8fDv8O/u7/Dw8e/v8O7v8O7w8PDx8e/w8O7v7/Dx8O/w7+7v7vLz8fX28/X28vT08Pb28/X18vT08fPz8PX18/Ly8PHx7/j49/X19PLy8fHx8PDw7+/v7vj38vr48PXz6/r59fj38/b18fr48fn38Pr37/j17fbz6/Tx6fn38fj28Pf28/X08fr48/n38vj28fr38Pj17vr38fr49Pn38/f18fn49vf29Pb18/X08vTz8fv48/r38vn28fn39Pj28/f18/X08/Py8fLx8PHw7/Dv7vPx8fHv7/Tz8/Py8vLx8fHw8PDv7+/u7vf39/X19fT09PPz8/Ly8vHx8fDw8O/v7+7u7u3t7ezs7Ovr6+rq6unp6ejo6Ofn5+Xl5ePj4+Li4uHh4d7e3tzc3Nvb29TU1NPT09LS0s7OzsnJycPDw8LCwsHBwcDAwL6+vr29vbu7u7m5ubi4uLe3t7a2trW1tbS0tLOzs7KysrCwsP///wAAACH5BAEAAH4ALAAAAAAgABgAAAf/gCmCg4QnPyQ3iYo3LjUjLCsqhJOTN1NWWFlam5wOWE1EMy0oNJSTUleaWlmsra4PUBAwOUGlpjdVq667uw4HCkYmLiiUG5q8yK4HCVgeEzO2gsbJrFiZrFfXrkhGLbY31NhcX5lXXl0Ou1BQGDaludRXYW5rVlZkc2dWvB9OL4bhsICZgweMlTF25HDRpqxHiw26kF1pw6fOQjh93GRh2AqBkSBUIu7C0mWOHj1sxODJoydNKmRHWoRMlikOHz50ytDZw0fOFo6slITQIXLXFTR23pi5ouaOGzJAWXU7EdUVmCzZtHzBmqwAhxMppjwI6Kpqlg8dcJSKYYBBuLesehx84GBjkJAnbuFSUxABCCEaOIxEgaK31xEJLURMogFEwJMshN8WaLWgiIxoi3H06EAARLIFUJIMIPykgjdTgmjQsFGiiBEnkbMs0ZDBAo8hPjQ0MAIN9V/VwFMAR4HCxokWPJhc6OHOt3NKqluUoLAD8/PrwkWAFRQIADs=) no-repeat 25px 0;padding:10px 60px 5px 60px;min-height:35px;line-height:1.6em;color:#333}</style>
<style media="only screen and (max-width: 767px)">body{font-size:14px!important;-webkit-text-size-adjust:none}.forpc{display:none!important}.navbar{display:none}body.has-navbar{background-position-y:unset;padding-top:unset}#sideBar{width:auto;float:none}#mainContent{float:none;margin-left:0}#mainContent .forFlow{margin-left:0}#main{width:auto;min-width:unset;padding:0 10px}#home{min-width:unset}</style>
<link type=application/rss+xml rel=alternate href=https://www.cnblogs.com/gelandesprung/rss>
<link type=application/rsd+xml rel=EditURI href=https://www.cnblogs.com/gelandesprung/rsd.xml>
<link type=application/wlwmanifest+xml rel=wlwmanifest href=https://www.cnblogs.com/gelandesprung/wlwmanifest.xml>
<link id=favicon rel="shortcut icon" href="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAzMiAzMiI+PGRlZnM+PGNsaXBQYXRoIGlkPSJwcmVmaXhfX2NsaXAtcGF0aCI+PHBhdGggY2xhc3M9InByZWZpeF9fY2xzLTEiIGQ9Ik0yOS40OCAyNS4yNGMtLjE2LTEuODktLjA4LTEuNS0uMjQtMy4xNmE3Mi4yNCA3Mi4yNCAwIDAwLTItMTAuMzdMMjYgNi4yNWwtMi42IDUuNDEtLjQ0Ljg5cS0uMjQuNDgtLjU0IDFhMjAuNDMgMjAuNDMgMCAwMS0xLjI0IDEuODQgMjAuMDggMjAuMDggMCAwMS0zLjA4IDMuMjQgMTkuNzIgMTkuNzIgMCAwMS0zLjg3IDIuNTNjLS43Mi4zMy0xLjQ1LjcxLTIuMjMgMS0uMzQuMTQtMS4xOS40NC0xLjkzLjY2YTIuNTUgMi41NSAwIDAxLTEuMDctLjNjLS4zNC0xLS44My0yLjI0LTEuMi0zLjE5LS41LTEuMjUtMS0yLjUtMS41MS0zLjczYTU5LjExIDU5LjExIDAgMDAtMy42Mi03LjI1IDU5LjgyIDU5LjgyIDAgMDAxLjUxIDcuOTRjLjMgMS4zLjcgMi41OCAxLjA1IDMuODdTNiAyMi43MSA2LjQ0IDI0YTEuNCAxLjQgMCAwMDEuMjkuOTNjMS4yOCAwIDIuNTcuMDYgMy44Ni4wNXMyLjU5IDAgMy44OC0uMTFhNTYgNTYgMCAwMDcuNzktLjg3Yy0xLjkyLS40OS03LjUtLjgxLTEwLjc5LTEuMDZhNDMgNDMgMCAwMDYuNTMtMS43IDI0LjA2IDI0LjA2IDAgMDA1LjM4LTMuNDVjLjcxLS42MiAxLjIxIDEuODggMi4zOSA1LjI3LjYyIDEuNjkuMzQgMSAxIDIuNjZzMS4zNyA0LjM4IDIuMTcgNmMtLjA3LTEuODItLjMxLTQuNjctLjQ2LTYuNDh6Ii8+PC9jbGlwUGF0aD48Y2xpcFBhdGggaWQ9InByZWZpeF9fY2xpcC1wYXRoLTIiPjxwYXRoIGNsYXNzPSJwcmVmaXhfX2Nscy0xIiBkPSJNMjAuOTIgMy40NmE0LjI1IDQuMjUgMCAwMS4zMSA1Ljg2IDMuOTEgMy45MSAwIDAxLTUuNjYuMjQgNC4yNSA0LjI1IDAgMDEtLjMxLTUuODYgMy45MSAzLjkxIDAgMDE1LjY2LS4yNG0xLjM1LTEuNTRhNS44OSA1Ljg5IDAgMDAtOC41My4zNiA2LjQxIDYuNDEgMCAwMC40OCA4LjgzIDUuOTEgNS45MSAwIDAwOC41My0uMzYgNi40MSA2LjQxIDAgMDAtLjQ4LTguODN6Ii8+PC9jbGlwUGF0aD48c3R5bGU+LnByZWZpeF9fY2xzLTF7ZmlsbDojM2UzYTM5fUBtZWRpYSAocHJlZmVycy1jb2xvci1zY2hlbWU6ZGFyayl7LnByZWZpeF9fY2xzLTF7ZmlsbDojZWZlZmVmfX08L3N0eWxlPjwvZGVmcz48ZyBzdHlsZT0iaXNvbGF0aW9uOmlzb2xhdGUiPjxnIGlkPSJwcmVmaXhfX2xheWVyXzEiIGRhdGEtbmFtZT0ibGF5ZXIgMSI+PHBhdGggY2xhc3M9InByZWZpeF9fY2xzLTEiIGQ9Ik0yOS40OCAyNS4yNGMtLjE2LTEuODktLjA4LTEuNS0uMjQtMy4xNmE3Mi4yNCA3Mi4yNCAwIDAwLTItMTAuMzdMMjYgNi4yNWwtMi42IDUuNDEtLjQ0Ljg5cS0uMjQuNDgtLjU0IDFhMjAuNDMgMjAuNDMgMCAwMS0xLjI0IDEuODQgMjAuMDggMjAuMDggMCAwMS0zLjA4IDMuMjQgMTkuNzIgMTkuNzIgMCAwMS0zLjg3IDIuNTNjLS43Mi4zMy0xLjQ1LjcxLTIuMjMgMS0uMzQuMTQtMS4xOS40NC0xLjkzLjY2YTIuNTUgMi41NSAwIDAxLTEuMDctLjNjLS4zNC0xLS44My0yLjI0LTEuMi0zLjE5LS41LTEuMjUtMS0yLjUtMS41MS0zLjczYTU5LjExIDU5LjExIDAgMDAtMy42Mi03LjI1IDU5LjgyIDU5LjgyIDAgMDAxLjUxIDcuOTRjLjMgMS4zLjcgMi41OCAxLjA1IDMuODdTNiAyMi43MSA2LjQ0IDI0YTEuNCAxLjQgMCAwMDEuMjkuOTNjMS4yOCAwIDIuNTcuMDYgMy44Ni4wNXMyLjU5IDAgMy44OC0uMTFhNTYgNTYgMCAwMDcuNzktLjg3Yy0xLjkyLS40OS03LjUtLjgxLTEwLjc5LTEuMDZhNDMgNDMgMCAwMDYuNTMtMS43IDI0LjA2IDI0LjA2IDAgMDA1LjM4LTMuNDVjLjcxLS42MiAxLjIxIDEuODggMi4zOSA1LjI3LjYyIDEuNjkuMzQgMSAxIDIuNjZzMS4zNyA0LjM4IDIuMTcgNmMtLjA3LTEuODItLjMxLTQuNjctLjQ2LTYuNDh6Ii8+PGcgY2xpcC1wYXRoPSJ1cmwoI3ByZWZpeF9fY2xpcC1wYXRoKSI+PHBhdGggY2xhc3M9InByZWZpeF9fY2xzLTEiIGQ9Ik0tLjg3LS43OGgzNC40MnYzMy4wN0gtLjg3eiIvPjwvZz48cGF0aCBjbGFzcz0icHJlZml4X19jbHMtMSIgZD0iTTIwLjkyIDMuNDZhNC4yNSA0LjI1IDAgMDEuMzEgNS44NiAzLjkxIDMuOTEgMCAwMS01LjY2LjI0IDQuMjUgNC4yNSAwIDAxLS4zMS01Ljg2IDMuOTEgMy45MSAwIDAxNS42Ni0uMjRtMS4zNS0xLjU0YTUuODkgNS44OSAwIDAwLTguNTMuMzYgNi40MSA2LjQxIDAgMDAuNDggOC44MyA1LjkxIDUuOTEgMCAwMDguNTMtLjM2IDYuNDEgNi40MSAwIDAwLS40OC04LjgzeiIvPjxnIGNsaXAtcGF0aD0idXJsKCNwcmVmaXhfX2NsaXAtcGF0aC0yKSI+PHBhdGggY2xhc3M9InByZWZpeF9fY2xzLTEiIGQ9Ik0tLjg3LS43OGgzNC40MnYzMy4wN0gtLjg3eiIvPjwvZz48L2c+PC9nPjwvc3ZnPg==" type=image/svg+xml><style>.sf-hidden{display:none!important}</style><link rel=canonical href=https://www.cnblogs.com/gelandesprung/p/13292659.html></head>
<body class="has-navbar has-bannerbar">
 <a name=top></a>
 <a target=_blank href="https://developer.aliyun.com/learning/trainingcamp/sc/3?spm=a1z389.11499242.0.0.65452413ceQQ9r&amp;utm_content=g_1000250169" class=sf-hidden>
 
 </a>
 <div id=bannerbar class="bannerbar-mobile formobile sf-hidden">
 
 </div>
 <div id=top_nav class="navbar forpc">
 <nav id=nav_main class="navbar-main sf-hidden">
 
 
 </nav>
 </div>
 
 
<div id=home>
<div id=header class=sf-hidden>
 
 
</div>
<div id=main>
 <div id=mainContent>
 <div class=forFlow>
 <div id=post_detail>
<div id=topics>
 <div class=post>
 <h1 class=postTitle>
 
<a id=cb_post_title_url class="postTitle2 vertical-middle" href=https://www.cnblogs.com/gelandesprung/p/13292659.html>
 <span>Docker部署NextCloud总结</span>
 
</a>
 </h1>
 <div class=clear></div>
 <div class=postBody>
 <div id=cnblogs_post_body class="blogpost-body blogpost-body-html">
<div class=exported-note-title>docker安装NextCloud</div>
<div id=rendered-md>
<h1 id=docker部署nextcloud总结>Docker部署NextCloud总结</h1>
<blockquote>
<blockquote>
<p>我反复的安装了很多遍，虽然最后成功了，但是我完全搞不清楚最后一次成功和以前的失败有什么的不同</p>
</blockquote>
</blockquote>
<h2 id=安装方法>安装方法</h2>
<p>我是通过配置脚本安装的，命令如下：</p>
<div class=joplin-editable>
<pre class="hljs codeblock"><code class="hljs css"><span class=hljs-selector-tag>docker-compose</span> <span class=hljs-selector-tag>-f</span> <span class=hljs-selector-tag>nc</span><span class=hljs-selector-class>.yml</span> <span class=hljs-selector-tag>up</span> <span class=hljs-selector-tag>-d</span></code></pre>
</div>
<p>完成之后通过<code class=inline-code>docker ps -a</code>查看安装之后的情况。如果安装不成功需要完全清除数据的时候需要把container停止掉，比如我安装失败的时候就是执行</p>
<div class=joplin-editable>
<pre class="hljs codeblock"><code class="hljs sql">docker <span class=hljs-keyword>stop</span> <span class=hljs-string>`id`</span></code></pre>
</div>
<p>然后</p>
<div class=joplin-editable>
<pre class="hljs codeblock"><code class="hljs powershell">docker<span class=hljs-literal>-compose</span> <span class=hljs-operator>-f</span> nc.yml <span class=hljs-built_in>rm</span> <span class=hljs-literal>-v</span></code></pre>
</div>
<p>这行命令比较彻底的清除数据，包括它创建的&nbsp;volume， 这东西一般的删除是不是清除它的，所以再次安装的时候仍然会从它里面拿数据，但是<code class=inline-code>rm -v</code>会比较彻底的清除。</p>
<h2 id=配置>配置</h2>
<ul>
<li>进入配置页面的时候数据库那块记得把localhost改成db,因为yml文件中mariadb的名字就是db，这一点我没有搞太清楚，不过这样做是对了。</li>
<li>国内有由墙的问题，NextCloud的插件不能从web端直接下载安装，所以需要从NextCloud的网站下载<code class=inline-code>gz</code>包，然后解压拷贝到NextCloud的数据目录下<code class=inline-code>apps/</code>里面，再通过web端<code class=inline-code>启用</code></li>
</ul>
<h2 id=安装之后的思考>安装之后的思考</h2>
<p>我是通过docker-compose执行配置脚本安装的，脚本是</p>
<div class=joplin-editable>
<pre class="hljs codeblock"><code class="hljs http"><span class=hljs-attr><span class=hljs-attribute>version</span>: <span class=hljs-string>'2'

<span class=hljs-attr><span class=yaml><span class=hljs-attr>services:</span>
  </span><span class=hljs-attr><span class=yaml><span class=hljs-attr>db:</span>
    </span><span class=hljs-attr><span class=yaml><span class=hljs-attr>image:</span> </span><span class=hljs-string><span class=yaml><span class=hljs-string>mariadb</span>
    </span><span class=hljs-attr><span class=yaml><span class=hljs-attr>command:</span> </span><span class=hljs-string><span class=yaml><span class=hljs-string>--transaction-isolation=READ-COMMITTED</span> </span><span class=hljs-string><span class=yaml><span class=hljs-string>--binlog-format=ROW</span>
    </span><span class=hljs-attr><span class=yaml><span class=hljs-attr>restart:</span> </span><span class=hljs-string><span class=yaml><span class=hljs-string>always</span>
    </span><span class=hljs-attr><span class=yaml><span class=hljs-attr>volumes:</span>
      </span><span class=hljs-bullet><span class=yaml><span class=hljs-bullet>-</span> </span><span class=hljs-string><span class=yaml><span class=hljs-string>/opt/extra/db:/var/lib/mysql</span>
    </span><span class=hljs-attr><span class=yaml><span class=hljs-attr>ports:</span>
      </span><span class=hljs-bullet><span class=yaml><span class=hljs-bullet>-</span> </span><span class=hljs-string><span class=yaml><span class=hljs-string>"3306:7988"</span>
    </span><span class=hljs-attr><span class=yaml><span class=hljs-attr>environment:</span>
      </span><span class=hljs-bullet><span class=yaml><span class=hljs-bullet>-</span> </span><span class=hljs-string><span class=yaml><span class=hljs-string>MYSQL_ROOT_PASSWORD=密码</span>
      </span><span class=hljs-bullet><span class=yaml><span class=hljs-bullet>-</span> </span><span class=hljs-string><span class=yaml><span class=hljs-string>MYSQL_PASSWORD=密码</span>
      </span><span class=hljs-bullet><span class=yaml><span class=hljs-bullet>-</span> </span><span class=hljs-string><span class=yaml><span class=hljs-string>MYSQL_DATABASE=nextcloud</span>
      </span><span class=hljs-bullet><span class=yaml><span class=hljs-bullet>-</span> </span><span class=hljs-string><span class=yaml><span class=hljs-string>MYSQL_USER=nextcloud</span>

  </span><span class=hljs-attr><span class=yaml><span class=hljs-attr>app:</span>
    </span><span class=hljs-attr><span class=yaml><span class=hljs-attr>image:</span> </span><span class=hljs-string><span class=yaml><span class=hljs-string>nextcloud</span>
    </span><span class=hljs-attr><span class=yaml><span class=hljs-attr>ports:</span>
      </span><span class=hljs-bullet><span class=yaml><span class=hljs-bullet>-</span> </span><span class=hljs-number><span class=yaml><span class=hljs-number>8686</span></span><span class=hljs-string><span class=yaml><span class=hljs-string>:80</span>
    </span><span class=hljs-attr><span class=yaml><span class=hljs-attr>depends_on:</span>
      </span><span class=hljs-bullet><span class=yaml><span class=hljs-bullet>-</span> </span><span class=hljs-string><span class=yaml><span class=hljs-string>db</span>
    </span><span class=hljs-attr><span class=yaml><span class=hljs-attr>volumes:</span>
      </span><span class=hljs-bullet><span class=yaml><span class=hljs-bullet>-</span> </span><span class=hljs-string><span class=yaml><span class=hljs-string>/opt/extra/nextcloud:/var/www/html</span>
    </span><span class=hljs-attr><span class=yaml><span class=hljs-attr>restart:</span> </span><span class=hljs-string><span class=yaml><span class=hljs-string>always</span>
</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></pre>
</div>
<p>这是个是最后成功的配置，虽然是成功的配置，但是我用这个配置也失败过一次，第二失不知道怎么回事就成功了。我google和百度了很多次，大部分人的建议是把以前失败的数据全部完全的删除，并且清除<code class=inline-code>container</code>，我总结了一下最后一次的特殊性，需要提醒的是就算是这么做也不一定成功.</p>
<ul>
<li>由于我把数据库和nextcloud的数据目录映射到了本地，所以我重新安装的的时候先把映射的这两个目录清空，包括隐藏文件</li>
<li>清除Container的时候使用上面提到的<code class=inline-code>docker-compose -f nc.yml rm -v</code>命令，务必保证环境是干净的。</li>
<li>配置文件中<code class=inline-code>db</code>的端口以前只有3306,我把它映射出来了</li>
<li>我把<code class=inline-code>yml</code>文件中的link换成了depends_on，因为有人说<code class=inline-code>link</code>没有用。</li>
<li>环境那一块设置密码的部分等号后面我以前有一个空格，后来我把空格去掉了，不知道是不是不相同。<br>以上就是我修改的部分，再次强调不一定有用，仅供参考。</li>
</ul>
</div>
</div>
<div id=MySignature class=sf-hidden></div>
<div class=clear></div>
<div id=blog_post_info_block class=sf-hidden>
 <div id=blog_post_info class=sf-hidden>
</div>
 
 
</div>
 </div>
 <div class=postDesc>posted @ 
<span id=post-date>2020-07-13 12:57</span>&nbsp;
<a href=https://www.cnblogs.com/gelandesprung/ class=sf-hidden>_Gelandesprung</a>&nbsp;
阅读(<span id=post_view_count>686</span>)&nbsp;
评论(<span id=post_comment_count>0</span>)&nbsp;
<a href="https://i.cnblogs.com/EditPosts.aspx?postid=13292659" rel=nofollow>编辑</a>&nbsp;
<a href=https://www.cnblogs.com/gelandesprung/p/13292659.html>收藏</a></div>
 </div>
 
 
</div>
<a name=!comments></a>
<div id=blog-comments-placeholder class=sf-hidden></div>
<div id=comment_form class="commentform sf-hidden">
 
 
 
 
 
 
 
 
 
 
 
 
 
</div>
</div>
 </div>
 </div>
 <div id=sideBar>
 <div id=sideBarMain class=sf-hidden>
 <div id=sidebar_news class="newsItem sf-hidden">
<div class="newsItem sf-hidden">
 
<div id=blog-news class=sf-hidden>
 
 <div id=profile_block class=sf-hidden>
 昵称：
 
 
 园龄：
 
 
 粉丝：
 
 
 关注：
 
 
 
 </div>
</div>
</div>
</div>
 <div id=calendar class=sf-hidden> 
 </div>
 
 <div id=leftcontentcontainer class=sf-hidden>
 
 
 </div>
 
 </div>
 </div>
 <div class=clear></div>
 </div>
 <div class=clear></div>
 <div id=footer class=sf-hidden>
 
Copyright © 2021 _Gelandesprung
 </div>
</div>
 
 
